<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>

    <link rel="stylesheet" type="text/css" href="css/normalize.css"/>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
    <link rel="stylesheet" type="text/css" href="css/jsmaps.css"/>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script src="js/jquery.smint.js" type="text/javascript"></script>
    <!-- jsmaps-panzoom.js is optional if you are using enablePanZoom -->
    <script src="js/jsmaps-libs.js" type="text/javascript"></script>
    <script src="js/jsmaps-panzoom.js"></script>
    <script src="js/jsmaps.js" type="text/javascript"></script>
    <script src="js/california.js" type="text/javascript"></script>
  </head>
  <body>

    <header class="stickynav">
      <nav>
        <a href="#intro"><div id="logo"></div></a>
        <a class="nav-item" href="#instability">Instability</a>
        <a class="nav-item" href="#shocks">Common Shocks</a>
        <a class="nav-item" href="#calfresh">How CalFresh Helps</a>
        <a class="nav-item" href="#explore">Explore Counties</a>
      </nav>
    </header>

    <div id="main" role="main">
      {{ content }}
    </div>

    <footer>
      2019 Code for America
    </footer>

    <script type="text/javascript">
      var quotes = {{site.data.quotes | jsonify}};

      var selectQuote = function(contentId, tabId) {
        $('#quote-content-'+contentId).html(quotes[contentId][tabId].quote);
        $('.quote-selector-tab.'+contentId).removeClass('selected');
        $('#quote-selector-tab-'+contentId+'-'+tabId).addClass('selected');
      };

      $(document).ready( function() {
        // SMINT sticky nav
	      $('.stickynav').smint({
          'mySelector': 'section',
          'scrollSpeed' : 1500
        });

        // Map
        $('#california-map').JSMaps({
           map: 'california'
        });

        // Scroll-top in top section
        $('.scroll-tip').click(function() {
          var navOffset = $('.smint').height();
          var goTo =  $('section.instability').position().top-navOffset;
  				$("html, body").stop().animate({ scrollTop: goTo }, 1500);
        });

        // Quote Explorers
        $('div.quote-selector-arrow.left').click(function() {
          var contentId = this.id.split('-')[4];
          var activeTab = $('.quote-selector-tab.'+contentId+'.selected');
          var activeTabId = parseInt(activeTab.attr('id').split('-')[4]);
          var newTabId = quotes[contentId].length - 1;
          if (activeTabId > 0) {
            newTabId = activeTabId - 1;
          }
          selectQuote(contentId, newTabId);
        });
        $('div.quote-selector-arrow.right').click(function() {
          var contentId = this.id.split('-')[4];
          var activeTab = $('.quote-selector-tab.'+contentId+'.selected');
          var activeTabId = parseInt(activeTab.attr('id').split('-')[4]);
          var newTabId = 0;
          if (activeTabId < quotes[contentId].length - 1) {
            newTabId = activeTabId + 1;
          }
          selectQuote(contentId, newTabId);
        });

        // Change nav bar color on scroll
        $(window).on("scroll", function() {
          if($(document).scrollTop() > $('section.instability').offset().top-140) {
            $("nav").addClass("scrolled");
          } else {
            //remove the background property so it comes transparent again (defined in your css)
            $("nav").removeClass("scrolled");
          }
        });
      });
    </script>

  </body>
</html>
